FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGt1YmV2aXJ0CmRlc2NyaXB0aW9uOiBBUEIgZm9yIG1hbmFnaW5n\
IEt1YmVWaXJ0IGRlcGxveW1lbnRzCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKbWV0\
YWRhdGE6CiAgZGlzcGxheU5hbWU6IGt1YmV2aXJ0IChBUEIpCiAgaW1hZ2VVcmw6IGh0dHBzOi8v\
Y2RuLnBicmQuY28vaW1hZ2VzL0g1R3V0ZDcucG5nCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAog\
ICAgZGVzY3JpcHRpb246IERlZmF1bHQgZGVwbG95bWVudCBwbGFuIGZvciBrdWJldmlydC1hcGIK\
ICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczoKICAgICAgLSB0\
aXRsZTogT3BlbnNoaWZ0IEFkbWluIFVzZXIKICAgICAgICBuYW1lOiBhZG1pbl91c2VyCiAgICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSB0aXRsZTogT3Bl\
bnNoaWZ0IEFkbWluIFBhc3N3b3JkCiAgICAgICAgbmFtZTogYWRtaW5fcGFzc3dvcmQKICAgICAg\
ICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRpc3BsYXlfdHlw\
ZTogcGFzc3dvcmQKICAgICAgLSBuYW1lOiByZWxlYXNlCiAgICAgICAgdGl0bGU6IFVzZSBSZWxl\
YXNlIGZpbGVzCiAgICAgICAgdHlwZTogYm9vbGVhbgogICAgICAgIGRlZmF1bHQ6IFRydWUKICAg\
ICAgLSBuYW1lOiB0YWcKICAgICAgICB0aXRsZTogVGFnIHRvIHVzZQogICAgICAgIHR5cGU6IHN0\
cmluZwogICAgICAgIGRlZmF1bHQ6IHNwcmludDUK"


COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
