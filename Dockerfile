FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGt1YmV2aXJ0LWFwYgpkZXNjcmlwdGlvbjogQVBCIGZvciBtYW5h\
Z2luZyBLdWJlVmlydCBkZXBsb3ltZW50cwpiaW5kYWJsZTogRmFsc2UKYXN5bmM6IG9wdGlvbmFs\
Cm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBrdWJldmlydApwbGFuczoKICAtIG5hbWU6IGRlZmF1\
bHQKICAgIGRlc2NyaXB0aW9uOiBEZWZhdWx0IGRlcGxveW1lbnQgcGxhbiBmb3Iga3ViZXZpcnQt\
YXBiCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6CiAgICAg\
IC0gbmFtZTogdGFnCiAgICAgICAgdGl0bGU6IEt1YmV2aXJ0IFZlcnNpb24KICAgICAgICB0eXBl\
OiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiB2MC4yLjAKICAgICAgLSBuYW1lOiBhZG1pbl91c2Vy\
CiAgICAgICAgdGl0bGU6IE9wZW5zaGlmdCBhZG1pbl91c2VyCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgZGVmYXVsdDogZGV2ZWxvcGVyCiAgICAgIC0gbmFtZTogYWRtaW5fcGFzc3dvcmQK\
ICAgICAgICB0aXRsZTogT3BlbnNoaWZ0IGFkbWluX3Bhc3N3b3JkCiAgICAgICAgdHlwZTogc3Ry\
aW5nCiAgICAgICAgZGVmYXVsdDogZGV2ZWxvcGVyCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
